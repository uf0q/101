<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø¨Ø±Ø§ Ø§Ù„Ø³Ø§Ù„ÙØ© </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <style>
        /* Ø§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø®Ù„ÙÙŠØ© */
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        body {
            font-family: 'Cairo', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1f2838, #0a0e14);
            color: #f1f1f1;
            direction: rtl;
            text-align: center;
            display: flex; /* Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙ„ÙŠÙƒØ³ Ø¨ÙˆÙƒØ³ Ù„ØªÙˆØ³ÙŠØ· Ø§Ù„Ø­Ø§ÙˆÙŠØ© */
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù‡Ø§ØªÙ */
        .mobile-container {
            width: 100%;
            max-width: 450px;
            height: 90vh;
            max-height: 900px;
            background: #151d28; /* Ù„ÙˆÙ† Ø®Ù„ÙÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¥Ø·Ø§Ø± */
            border-radius: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow-y: auto; /* ØªÙ…ÙƒÙŠÙ† Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ */
            overflow-x: hidden;
        }

        /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© */
        .back-button {
            position: absolute;
            top: 20px;
            right: 20px;
            color: #72efdd;
            font-size: 1.5em;
            text-decoration: none;
            transition: transform 0.2s ease;
            z-index: 100;
        }
        .back-button:hover {
            transform: scale(1.1);
        }

        /* Ø­Ø§ÙˆÙŠØ§Øª Ø§Ù„Ø´Ø§Ø´Ø§Øª ÙˆØ§Ù„ÙˆØ§Ø¬Ù‡Ø© */
        .screen {
            display: none;
            padding: 40px 20px;
            min-height: 100%;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            width: 100%;
            animation: fadeIn 0.8s ease-in-out;
            box-sizing: border-box; /* Ù„Ø¶Ù…Ø§Ù† Ø£Ù† Ø§Ù„Ø¨Ø§Ø¯ÙŠÙ†Øº Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¶ */
        }
        .active {
            display: flex;
        }
        .box {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙˆØ§Ù„ÙÙ‚Ø±Ø§Øª */
        h1 {
            color: #72efdd;
            margin-bottom: 15px;
            font-size: 2.5em;
        }
        p {
            color: #d8f1f0;
            margin: 10px 0;
            line-height: 1.6;
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        button, input[type="text"], select {
            font-family: 'Cairo', sans-serif;
            font-size: 1.1em;
            padding: 12px 25px;
            border-radius: 8px;
            border: none;
            margin: 10px;
            cursor: pointer;
            transition: transform 0.2s ease, background-color 0.3s ease;
            text-align: center;
        }
        button {
            background-color: #72efdd;
            color: #1f2838;
            font-weight: bold;
        }
        button:hover {
            transform: translateY(-3px);
            background-color: #5ce0c7;
        }
        input[type="text"], select {
            background-color: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        input[type="text"]::placeholder {
            color: #aaa;
            text-align: right;
        }
        
        /* Ø´Ø¨ÙƒØ© Ø§Ù„ÙØ¦Ø§Øª */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .category-option {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s ease, background-color 0.3s ease;
        }
        .category-option:hover {
            transform: scale(1.05);
            background-color: rgba(255, 255, 255, 0.2);
        }
        .category-option i {
            font-size: 3em;
            margin-bottom: 10px;
            color: #72efdd;
        }
        .category-option span {
            font-weight: bold;
        }
        
        /* Ù„ÙˆØ­Ø© Ø§Ù„Ù†Ù‚Ø§Ø· - Ø¯Ø§Ø®Ù„ Ø´Ø§Ø´Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© */
        #final-scoreboard {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }
        #final-scoreboard h3 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #fff;
        }
        .score-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 1.1em;
        }
        .score-item span {
            font-weight: bold;
        }
        .score-item .player-name {
            color: #72efdd;
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        #game-screen .box {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #game-info {
            background: rgba(0,0,0,0.2);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            width: 100%;
        }
        #game-info p {
            font-size: 1.2em;
        }
        #timer {
            font-size: 2em;
            font-weight: bold;
            color: #ff6b6b;
            margin-top: 10px;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØµÙˆÙŠØª */
        #vote-options label {
            display: block;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        #vote-options label:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        #vote-options input[type="radio"] {
            display: none;
        }
        #vote-options input[type="radio"]:checked + label {
            background-color: #72efdd;
            color: #1f2838;
        }

        /* Ø§Ù„Ø£Ù†Ù…ÙŠØ´Ù† */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        #animation-screen {
            background-color: #1f2838;
            opacity: 0.95;
            z-index: 2000;
            transition: opacity 0.5s ease-in-out;
        }

        /* Media Queries Ù„Ø¶Ø¨Ø· Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 600px) {
            body {
                font-size: 14px;
            }
            .mobile-container {
                height: 100vh;
                max-height: none;
                max-width: none;
                border-radius: 0;
                box-shadow: none;
                overflow-y: auto; /* ØªÙ…ÙƒÙŠÙ† Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„ */
            }
            .screen {
                padding: 20px 10px;
            }
            .box {
                padding: 20px;
                width: 95%;
            }
            h1 {
                font-size: 1.8em;
            }
            p {
                font-size: 1em;
            }
            button, input[type="text"], select {
                font-size: 1em;
                padding: 10px 20px;
            }
            .category-option {
                padding: 15px;
            }
            .category-option i {
                font-size: 2.5em;
            }
            #game-info {
                padding: 15px;
            }
            #timer {
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>

    <div class="mobile-container">
        <a href="index.html" class="back-button" title="Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">
            <i class="fas fa-home"></i>
        </a>
        
        <div id="category-screen" class="screen active">
            <div class="box">
                <h1>Ø§Ø®ØªØ± ÙØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨ ğŸ•¹ï¸</h1>
                <p>Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©. Ø³ÙŠØªÙˆØ¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹ Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø´ÙŠØ¡ Ø¨Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø´Ø®Øµ ÙˆØ§Ø­Ø¯!</p>
                <div id="category-options" class="category-grid"></div>
            </div>
        </div>

        <div id="setup-screen" class="screen">
            <div class="box">
                <h1>Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø© ğŸ‘¥</h1>
                <form id="setup-form">
                    <label for="numPlayers">Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† (3-6):</label>
                    <select id="numPlayers">
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                    <button type="submit">Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </form>
                <button id="back-to-category-btn">Ø±Ø¬ÙˆØ¹</button>
            </div>
        </div>

        <div id="names-screen" class="screen">
            <div class="box">
                <h1>Ø£Ø¯Ø®Ù„ÙˆØ§ Ø£Ø³Ù…Ø§Ø¡ÙƒÙ… âœï¸</h1>
                <form id="names-form">
                    <div id="names-container"></div>
                    <button type="submit">Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
                </form>
                <button id="back-to-setup-btn">Ø±Ø¬ÙˆØ¹</button>
            </div>
        </div>

        <div id="role-screen" class="screen">
            <div class="box">
                <h1>Ø¯ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù† ğŸ¤«</h1>
                <p id="role-player-name"></p>
                <p id="role-message">Ø£Ù…Ø³Ùƒ Ø§Ù„Ù‡Ø§ØªÙ Ø¬ÙŠØ¯Ø§Ù‹ ÙˆØ§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ù„Ù…Ø¹Ø±ÙØ© Ø¯ÙˆØ±Ùƒ. Ù„Ø§ ØªØ¯Ø¹ Ø£Ø­Ø¯Ù‹Ø§ ÙŠØ±Ù‰!</p>
                <button id="reveal-role-btn">Ø£Ù†Ø§ Ø¬Ø§Ù‡Ø²</button>
                <button id="next-role-btn" style="display:none;">Ø§Ù„ØªØ§Ù„ÙŠ</button>
                <button id="back-to-names-btn">Ø±Ø¬ÙˆØ¹</button>
            </div>
        </div>

        <div id="game-screen" class="screen">
            <div class="box">
                <h1>Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¬ÙˆØ§Ø¨ ğŸ”</h1>
                <div id="game-info">
                    <p id="turn-info"></p>
                    <p id="timer"></p>
                </div>
                <button id="next-turn-btn">Ø§Ù„Ø¯ÙˆØ± Ø§Ù„ØªØ§Ù„ÙŠ</button>
                <button id="go-to-vote-btn">Ø¨Ø¯Ø¡ Ø§Ù„ØªØµÙˆÙŠØª</button>
            </div>
        </div>

        <div id="vote-collecting-screen" class="screen">
            <div class="box">
                <h1 id="voting-player-name"></h1>
                <p>Ù…Ù† Ù‡Ùˆ Ø¨Ø±Ø£ÙŠÙƒ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØ¹Ø±Ù Ø§Ù„Ø´ÙŠØ¡ØŸ</p>
                <form id="voting-form">
                    <div id="vote-options-collect"></div>
                    <button type="submit">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØµÙˆÙŠØª</button>
                </form>
            </div>
        </div>

        <div id="result-screen" class="screen">
            <div class="box">
                <h1>Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¬ÙˆÙ„Ø© ğŸ</h1>
                <p id="result-message"></p>
                <div id="final-scoreboard">
                    <h3>ğŸ† Ù„ÙˆØ­Ø© Ø§Ù„Ù†Ù‚Ø§Ø·</h3>
                    <div id="score-content"></div>
                </div>
                <button class="next-round-btn" id="next-round-btn">Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
                <button id="restart-btn">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
            </div>
        </div>

        <div id="animation-screen" class="screen" style="display: none;">
            <div class="box" style="padding: 50px;">
                <p id="animation-content" style="font-size: 2em; font-weight: bold;"></p>
            </div>
        </div>
    </div>
    
    <audio id="beep-sound" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" preload="auto"></audio>
    <audio id="win-sound" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" preload="auto"></audio>
    <audio id="lose-sound" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3" preload="auto"></audio>

    <script>
        // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        let numPlayers, chosenItem, liarIndex;
        let players = [];
        let scoreboard = {};
        let round = 1;
        let roleIndex = 0;
        let gameTimer;
        let timeRemaining = 120;
        let currentTurnIndex = 0;
        let votes = {};
        let votingPlayerIndex = 0;

        // Ø§Ù„ÙØ¦Ø§Øª ÙˆØ§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø­Ø¯Ø«Ø©
        const categories = {
            "Ø£ÙÙ„Ø§Ù…": ["Ø¥Ù†ØªØ±Ø³ØªÙŠÙ„Ø±", "Ø§Ù„Ø¬ÙˆÙƒØ±", "Ø¨Ø§Ø±Ø§Ø³Ø§ÙŠØª", "Ø³ÙŠÙƒØ§Ø±ÙŠÙˆ", "ÙØ§ÙŠØª ÙƒÙ„ÙˆØ¨", "Ù…Ø§Ø¯ Ù…Ø§ÙƒØ³: ÙÙŠÙˆØ±ÙŠ Ø±ÙˆØ¯", "Ø°Ø§ Ø¯Ø§Ø±Ùƒ Ù†Ø§ÙŠØª"],
            "Ø£Ù…Ø§ÙƒÙ†": ["Ø¨Ø§Ø±ÙŠØ³", "Ø§Ù„Ø£Ù‡Ø±Ø§Ù…Ø§Øª", "Ø¨Ø±Ø¬ Ø®Ù„ÙŠÙØ©", "Ø³ÙˆØ± Ø§Ù„ØµÙŠÙ† Ø§Ù„Ø¹Ø¸ÙŠÙ…", "Ø§Ù„ÙƒÙˆÙ„ÙˆØ³ÙŠÙˆÙ…", "Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©", "Ø³Ø¯ÙŠÙ… Ø£ÙˆØ±ÙŠÙˆÙ†", "ØºØ±Ø§Ù†Ø¯ ÙƒØ§Ù†ÙŠÙˆÙ†"],
            "Ø´Ø®ØµÙŠØ§Øª ØªØ§Ø±ÙŠØ®ÙŠØ©": ["Ø£Ø­Ù…Ø¯ Ø¨Ù† Ù…Ø§Ø¬Ø¯", "Ø§Ø¨Ù† Ø¨Ø·ÙˆØ·Ø©", "Ø§Ø¨Ù† Ø³ÙŠÙ†Ø§", "Ø§Ù„Ø­Ù„Ø§Ø¬", "ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ø£ÙŠÙˆØ¨ÙŠ", "Ø¹Ù…Ø± Ø§Ù„Ù…Ø®ØªØ§Ø±", "Ø¬ÙˆÙ„ÙŠÙˆØ³ Ù‚ÙŠØµØ±"],
            "Ø£ÙƒÙ„Ø§Øª Ø¹Ø§Ù„Ù…ÙŠØ©": ["Ø¨ÙŠØªØ²Ø§", "Ø³ÙˆØ´ÙŠ", "ØªØ§ÙƒÙˆ", "Ø¨Ø§Ø³ØªØ§", "Ø¨Ø±Ø¬Ø±", "Ø¯Ø¬Ø§Ø¬ ØªÙ†Ø¯ÙˆØ±ÙŠ", "ÙÙ„Ø§ÙÙ„", "ÙƒØ´Ø±ÙŠ"],
            "Ø±ÙŠØ§Ø¶Ø©": ["Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ", "Ù…Ø§ÙŠÙƒÙ„ Ø¬ÙˆØ±Ø¯Ù†", "Ø¯ÙŠÙŠØºÙˆ Ù…Ø§Ø±Ø§Ø¯ÙˆÙ†Ø§", "Ù„ÙŠØ¨Ø±ÙˆÙ† Ø¬ÙŠÙ…Ø³", "Ù…Ø§ÙŠÙƒ ØªØ§ÙŠØ³ÙˆÙ†", "Ø±Ø§ÙØ§Ø¦ÙŠÙ„ Ù†Ø§Ø¯Ø§Ù„", "Ø±ÙˆØ¬ÙŠÙ‡ ÙÙŠØ¯Ø±Ø±"],
            "Ø£Ù„Ø¹Ø§Ø¨ ÙÙŠØ¯ÙŠÙˆ": ["Ù…Ø§ÙŠÙ†ÙƒØ±Ø§ÙØª", "Ø¬Ø±Ø§Ù†Ø¯ Ø«ÙŠÙØª Ø£ÙˆØªÙˆ", "ÙÙŠÙØ§", "ÙÙˆØ±ØªÙ†Ø§ÙŠØª", "ÙƒÙˆÙ„ Ø£ÙˆÙ Ø¯ÙŠÙˆØªÙŠ", "Ø±ÙŠØ¯ Ø¯ÙŠØ¯ Ø±ÙŠØ¯Ù…Ø¨Ø´Ù†", "Ø£Ø³Ø§Ø³Ù†Ø² ÙƒØ±ÙŠØ¯"]
        };

        const categoryIcons = {
            "Ø£ÙÙ„Ø§Ù…": "fa-film",
            "Ø£Ù…Ø§ÙƒÙ†": "fa-landmark",
            "Ø´Ø®ØµÙŠØ§Øª ØªØ§Ø±ÙŠØ®ÙŠØ©": "fa-scroll",
            "Ø£ÙƒÙ„Ø§Øª Ø¹Ø§Ù„Ù…ÙŠØ©": "fa-pizza-slice",
            "Ø±ÙŠØ§Ø¶Ø©": "fa-basketball-ball",
            "Ø£Ù„Ø¹Ø§Ø¨ ÙÙŠØ¯ÙŠÙˆ": "fa-gamepad"
        };
        
        // Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ©
        const beepSound = document.getElementById("beep-sound");
        const winSound = document.getElementById("win-sound");
        const loseSound = document.getElementById("lose-sound");

        function playSound(sound) {
            sound.play();
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø£Ø³Ø§Ø³ÙŠØ©
        function switchScreen(fromId, toId) {
            const fromScreen = document.getElementById(fromId);
            const toScreen = document.getElementById(toId);
            if (fromScreen) fromScreen.classList.remove("active");
            if (toScreen) toScreen.classList.add("active");
        }

        function updateScoreboard() {
            let boardContent = document.getElementById("score-content");
            boardContent.innerHTML = "";
            let sortedPlayers = Object.keys(scoreboard).sort((a, b) => scoreboard[b] - scoreboard[a]);
            sortedPlayers.forEach(name => {
                let scoreItem = document.createElement("div");
                scoreItem.classList.add("score-item");
                let playerName = document.createElement("span");
                playerName.classList.add("player-name");
                playerName.innerText = name;
                let playerScore = document.createElement("span");
                playerScore.innerText = scoreboard[name];
                scoreItem.appendChild(playerName);
                scoreItem.appendChild(playerScore);
                boardContent.appendChild(scoreItem);
            });
        }
        
        // Ø´Ø§Ø´Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ¦Ø©
        function generateCategoryOptions() {
            const container = document.getElementById("category-options");
            container.innerHTML = "";
            for (let cat in categories) {
                let div = document.createElement("div");
                div.classList.add("category-option");
                div.setAttribute("data-category", cat);
                let icon = document.createElement("i");
                icon.classList.add("fas", categoryIcons[cat]);
                div.appendChild(icon);
                let span = document.createElement("span");
                span.innerText = cat;
                div.appendChild(span);
                div.addEventListener("click", function() {
                    let items = categories[cat];
                    chosenItem = items[Math.floor(Math.random() * items.length)];
                    switchScreen("category-screen", "setup-screen");
                });
                container.appendChild(div);
            }
        }
        generateCategoryOptions();
        
        // Ø´Ø§Ø´Ø© Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
        document.getElementById("setup-form").addEventListener("submit", function(e) {
            e.preventDefault();
            numPlayers = parseInt(document.getElementById("numPlayers").value);
            switchScreen("setup-screen", "names-screen");
            generateNameInputs();
        });

        // Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù…Ù† Ø´Ø§Ø´Ø© Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
        document.getElementById("back-to-category-btn").addEventListener("click", function() {
            if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¹ÙˆØ¯Ø©ØŸ Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.")) {
                switchScreen("setup-screen", "category-screen");
            }
        });
        
        function generateNameInputs() {
            const container = document.getElementById("names-container");
            container.innerHTML = "";
            for(let i = 0; i < numPlayers; i++){
                let input = document.createElement("input");
                input.type = "text";
                input.required = true;
                input.placeholder = "Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ " + (i + 1);
                input.id = "playerName" + i;
                container.appendChild(input);
            }
        }
        
        // Ø´Ø§Ø´Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡
        document.getElementById("names-form").addEventListener("submit", function(e) {
            e.preventDefault();
            players = [];
            for(let i = 0; i < numPlayers; i++){
                let name = document.getElementById("playerName" + i).value.trim();
                if(name === ""){
                    alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†.");
                    return;
                }
                players.push(name);
                if (scoreboard[name] === undefined) {
                    scoreboard[name] = 0;
                }
            }
            liarIndex = Math.floor(Math.random() * numPlayers);
            switchScreen("names-screen", "role-screen");
            roleIndex = 0;
            updateRoleScreen();
        });

        // Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù…Ù† Ø´Ø§Ø´Ø© Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡
        document.getElementById("back-to-setup-btn").addEventListener("click", function() {
            if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¹ÙˆØ¯Ø©ØŸ Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ØªÙŠ Ø£Ø¯Ø®Ù„ØªÙ‡Ø§.")) {
                switchScreen("names-screen", "setup-screen");
            }
        });
        
        // Ø´Ø§Ø´Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø¯ÙˆØ±
        function updateRoleScreen() {
            if(roleIndex >= players.length) {
                switchScreen("role-screen", "game-screen");
                startGameTimer();
                return;
            }
            document.getElementById("role-player-name").innerText = players[roleIndex];
            document.getElementById("role-message").innerHTML = "Ø£Ù…Ø³Ùƒ Ø§Ù„Ù‡Ø§ØªÙ Ø¬ÙŠØ¯Ø§Ù‹ ÙˆØ§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ù„Ù…Ø¹Ø±ÙØ© Ø¯ÙˆØ±Ùƒ. Ù„Ø§ ØªØ¯Ø¹ Ø£Ø­Ø¯Ù‹Ø§ ÙŠØ±Ù‰!";
            document.getElementById("reveal-role-btn").style.display = "inline-block";
            document.getElementById("next-role-btn").style.display = "none";
        }
        
        document.getElementById("reveal-role-btn").addEventListener("click", function() {
            let messageElem = document.getElementById("role-message");
            if(roleIndex === liarIndex) {
                messageElem.innerHTML = `Ø£Ù†Øª <span style="color: #ff6b6b; font-weight: bold;">"Ø¨Ø±Ø§ Ø§Ù„Ø³Ø§Ù„ÙØ©"</span>! <br> Ø¯ÙˆØ±Ùƒ Ù‡Ùˆ Ø§Ù„Ø®Ø¯Ø§Ø¹ ÙˆØ§Ù„Ù…Ø±Ø§ÙˆØºØ©.`;
            } else {
                messageElem.innerHTML = `Ø§Ù„Ø´ÙŠØ¡ Ù‡Ùˆ: <span style="color: #72efdd; font-weight: bold;">${chosenItem}</span>`;
            }
            document.getElementById("reveal-role-btn").style.display = "none";
            document.getElementById("next-role-btn").style.display = "inline-block";
        });
        
        document.getElementById("next-role-btn").addEventListener("click", function() {
            roleIndex++;
            updateRoleScreen();
        });

        // Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù…Ù† Ø´Ø§Ø´Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø¯ÙˆØ±
        document.getElementById("back-to-names-btn").addEventListener("click", function() {
            if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¹ÙˆØ¯Ø©ØŸ Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø¯ÙˆØ§Ø±.")) {
                switchScreen("role-screen", "names-screen");
            }
        });
        
        // Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¬ÙˆØ§Ø¨
        function startGameTimer() {
            timeRemaining = 120;
            currentTurnIndex = 0;
            document.getElementById("go-to-vote-btn").style.display = "block";
            document.getElementById("next-turn-btn").style.display = "inline-block";
            updateTurnInfo();
            gameTimer = setInterval(() => {
                timeRemaining--;
                let minutes = Math.floor(timeRemaining / 60);
                let seconds = timeRemaining % 60;
                document.getElementById("timer").innerText = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                if (timeRemaining <= 10 && timeRemaining > 0) {
                    playSound(beepSound);
                }
                if (timeRemaining <= 0) {
                    clearInterval(gameTimer);
                    endGameInterrogation();
                }
            }, 1000);
        }
        
        function updateTurnInfo() {
            const askerIndex = currentTurnIndex % players.length;
            const targetIndex = (currentTurnIndex + 1) % players.length;
            document.getElementById("turn-info").innerText = `Ø¯ÙˆØ± Ø§Ù„Ø³Ø¤Ø§Ù„: ${players[askerIndex]} ÙŠØ³Ø£Ù„ ${players[targetIndex]}.`;
        }
        
        document.getElementById("next-turn-btn").addEventListener("click", function() {
            currentTurnIndex++;
            updateTurnInfo();
        });
        
        function endGameInterrogation() {
            document.getElementById("next-turn-btn").style.display = "none";
            document.getElementById("go-to-vote-btn").style.display = "block";
            document.getElementById("turn-info").innerText = "Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬ÙˆØ§Ø¨! Ø§Ø¶ØºØ·ÙˆØ§ Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„ØªØµÙˆÙŠØª.";
        }
        
        document.getElementById("go-to-vote-btn").addEventListener("click", function() {
            clearInterval(gameTimer);
            switchScreen("game-screen", "vote-collecting-screen");
            startVotingProcess();
        });
        
        // Ø´Ø§Ø´Ø© Ø§Ù„ØªØµÙˆÙŠØª
        function startVotingProcess() {
            votingPlayerIndex = 0;
            votes = {};
            displayVotingScreen();
        }

        function displayVotingScreen() {
            if (votingPlayerIndex >= players.length) {
                tallyVotes();
                return;
            }

            switchScreen("vote-collecting-screen", "vote-collecting-screen");
            document.getElementById("voting-player-name").innerText = `Ø¯ÙˆØ± Ø§Ù„ØªØµÙˆÙŠØª: ${players[votingPlayerIndex]}`;
            
            let voteDiv = document.getElementById("vote-options-collect");
            voteDiv.innerHTML = "";
            players.forEach((player, index) => {
                if (index !== votingPlayerIndex) {
                    let label = document.createElement("label");
                    label.innerHTML = `<input type="radio" name="vote" value="${index}"> ${player}`;
                    voteDiv.appendChild(label);
                }
            });
        }

        document.getElementById("voting-form").addEventListener("submit", function(e) {
            e.preventDefault();
            let voteInput = document.querySelector('#vote-options-collect input[name="vote"]:checked');
            if(!voteInput) {
                alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù„Ø§Ø¹Ø¨ Ù„Ù„ØªØµÙˆÙŠØª.");
                return;
            }
            let votedIndex = parseInt(voteInput.value);
            let votedPlayerName = players[votedIndex];
            votes[votedPlayerName] = (votes[votedPlayerName] || 0) + 1;

            votingPlayerIndex++;
            displayVotingScreen();
        });

        function tallyVotes() {
            let maxVotes = 0;
            let mostVotedPlayer = null;
            let tie = false;
            
            for (const player in votes) {
                if (votes[player] > maxVotes) {
                    maxVotes = votes[player];
                    mostVotedPlayer = player;
                    tie = false;
                } else if (votes[player] === maxVotes) {
                    tie = true;
                }
            }

            let resultMsg = "";
            if (mostVotedPlayer === players[liarIndex] && !tie) {
                resultMsg = `ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ù„Ù‚Ø¯ ÙƒØ´ÙØªÙ… Ø§Ù„Ù„Ø§Ø¹Ø¨ <span style="color:#ff6b6b; font-weight: bold;">${players[liarIndex]}</span> Ø§Ù„Ø°ÙŠ ÙƒØ§Ù† "Ø¨Ø±Ø§ Ø§Ù„Ø³Ø§Ù„ÙØ©"!`;
                players.forEach((player, idx) => {
                    if(idx !== liarIndex) scoreboard[player] += 1;
                });
                playSound(winSound);
            } else {
                resultMsg = `Ù„Ù„Ø£Ø³Ù! ÙØ´Ù„ØªÙ… ÙÙŠ ÙƒØ´ÙÙ‡. Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø°ÙŠ ÙƒØ§Ù† "Ø¨Ø±Ø§ Ø§Ù„Ø³Ø§Ù„ÙØ©" Ù‡Ùˆ <span style="color:#ff6b6b; font-weight: bold;">${players[liarIndex]}</span>.`;
                scoreboard[players[liarIndex]] += 2;
                playSound(loseSound);
            }

            document.getElementById("result-message").innerHTML = resultMsg;
            updateScoreboard();
            switchScreen("vote-collecting-screen", "result-screen");
            playAnimation();
        }
        
        // Ø´Ø§Ø´Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø©
        document.getElementById("next-round-btn").addEventListener("click", function() {
            round++;
            liarIndex = Math.floor(Math.random() * numPlayers);
            let categoriesKeys = Object.keys(categories);
            let randomCategory = categoriesKeys[Math.floor(Math.random() * categoriesKeys.length)];
            chosenItem = categories[randomCategory][Math.floor(Math.random() * categories[randomCategory].length)];
            
            roleIndex = 0;
            switchScreen("result-screen", "role-screen");
            updateRoleScreen();
        });
        
        document.getElementById("restart-btn").addEventListener("click", function() {
            location.reload();
        });
        
        // Ø§Ù„Ø£Ù†Ù…ÙŠØ´Ù†
        function playAnimation() {
            let animScreen = document.getElementById("animation-screen");
            let content = document.getElementById("animation-content");
            animScreen.style.display = "flex";
            content.innerText = "ÙƒØ´Ù Ø§Ù„Ù‡ÙˆÙŠØ©... ğŸ•µï¸â€â™‚ï¸";
            setTimeout(() => {
                content.innerText = `Ø§Ù„Ù„Ø§Ø¹Ø¨ ${players[liarIndex]} Ù‡Ùˆ Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØ¹Ø±Ù Ø§Ù„Ø´ÙŠØ¡!`;
                setTimeout(() => {
                    animScreen.style.display = "none";
                }, 3000);
            }, 3000);
        }
    </script>
</body>
</html>